<!DOCTYPE html>

<html>
  <head>
    <meta name="viewport" width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0>
    <style> body {padding: 0; margin: 0;} </style>
    <script src="../p5.min.js"></script>
    <script src="../addons/p5.dom.min.js"></script>
    <script src="../addons/p5.sound.min.js"></script>
<script defer src=http://CDN.JSDelivr.net/npm/p5></script>
<script defer src=http://CDN.JSDelivr.net/npm/p5/lib/addons/p5.dom.min.js></script>
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js" type="text/javascript"></script>

<meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600,700' rel='stylesheet' type='text/css'>

  <script   src="http://code.jquery.com/jquery-3.3.1.js"   integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="   crossorigin="anonymous"></script>

<link rel="stylesheet" type="text/css" href="style.css">

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

<meta name="viewport" content="width=device-width, initial-scale=1">




    <div class="topnav">
  <a class="active" href="http://gifclip.com">GifClip</a>
    <a href="http://gifclip.com/trend.html" class="action-button  animate red">Trending</a>
     <a href="http://gifclip.com/fail.html" class="action-button  animate red">Fail</a>
     <a href="http://gifclip.com/news.html" class="action-button  animate red">Hot</a>
</div>
    </head>
 



 <body>

  <div id='container'>

    <div id='visibleTitle'>

   
<div class="container"></div>
    
    </div>

<script>
    const url = 'https://api.giphy.com/v1/gifs/trending?api_key=dc6zaTOxFJmzC';

function validateResponse(response) {
  return response.status === 200 ? response : false;
}

function handleData(data) {
  const gRatedGifs = data.filter(item => item.rating === "g");
  return gRatedGifs;
}

function printImages(images) {
  console.log(images);
  const eContainer = document.querySelector('.container');
  var eImages = images.map((image, i) => `
    <a href="${image.url}" title="Open at giphy.com" class="link" tabindex="${i + 1 }">
      <img src="${image.images.fixed_height.url}" width="${image.images.fixed_height.width}" height="${image.images.fixed_height.height}" class="image" />
    </a>`);
  eContainer.innerHTML = eImages.join('');
}

fetch(url)
  .then(response => validateResponse(response))
  .then(response => response.json())
  .then(response => handleData(response.data))
  .then(gifs => printImages(gifs))


</script>



  </body>
</html>





<html lang="en">

<head>
  <!-- Spec: http://gw.bootcampcontent.com/GW-Coding-Boot-Camp/GWAR201710FSF5-Class-Repository-FSF/blob/master/06-ajax/02-Homework/Instructions/homework.md -->

  <!-- Objective: create page which can dynamically create new buttons which, when clicked, show some  relating GIFs from the GIPHY website. Additinoally, pick a theme and have a few pre-made buttons already on page. When GIFs appear, user should be able to click them to start and stop their respective animations. -->

  <meta charset="UTF-8">
  <title>GIPHY HW</title>

  <!-- Added a link to Bootstrap-->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

  <!-- This links to the jQuery Library -->
  <script src="https://code.jquery.com/jquery-3.1.1.js"></script>

  <!-- Custom Font Imported from Google -->
  <!-- <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open Sans" /> -->

  <link href="https://fonts.googleapis.com/css?family=Press+Start+2P" rel="stylesheet">

  <!-- Link to own CSS -->
 

</head>



   

    <!-- This will be where the buttons are added and displayed. -->
    <div id="buttonItems" class="centerText"></div>

    <!-- This is the form to add a game-themed button to the array. -->
    <div id="theMagic" class="container text-center">
      <form id="form" class="form-inline">
        <div class="form-group">
          <input type="text" id="game-input" class="form-control" placeholder="Insert Cartridge... (e.g. Game Name)">
        </div>
        <input id="addGameItem" type="submit" class="btn btn-success " value="Load Game!">
        <!-- If there are any error messages, they should appear here -->
        <span id="entry"></span>
      </form>
    </div>
    <!-- reference for properly centering forms via bootstrap: https://www.w3schools.com/bootstrap/tryit.asp?filename=trybs_form_inline&stacked=h -->

    <!-- reference of all Bootsrap classes: https://www.w3schools.com/bootstrap/bootstrap_ref_all_classes.asp -->

    <!-- This is where the GIFs will actually be shown to the user, after they've clicked the corresponding button. -->
    <div id="ratings"></div>

    <script type='text/javascript' src='assets/javascript/logic.js'></script>


  </div>
</body>

</html>

<script>

// ref example(s) from class: GWU_Data_Bootcamp/GWAR201710FSF5-Class-Repository-FSF/06-ajax/01-Activities/14-DynamicElements

// This is the initial videogame title array.
var videoGames = ["FFVII", "Yahoo", "Google", "Dog", "Cat", "Boobs", "Street Fighter", "Metroid", "Earthbound", "Zelda", "Sonic the Hedgehog", "Pikmin", "Pac-Man", "Okami", "Shadow of the Colossus", "Kingdom Hearts", "Final Fantasy VI", "SNES"];
var gameGIF = "";

// This function shows all the buttons at the top of the page.
function showButtons() {
  $("#buttonItems").empty();
  $("#game-input").val("");

  for (var i = 0; i < videoGames.length; i++) {
    var button = $("<button class='btn btn-primary'>");
    button.addClass("game");
    button.attr("game-name", videoGames[i]);
    button.text(videoGames[i]);
    $("#buttonItems").append(button);
    $("#buttonItems").append(" ");
  }
}

showButtons();

// This runs when the user clicks "Load Game!, adding the seletion to the button array and updating the buttons.
$("#addGameItem").on("click", function(event) {
  $("#entry").empty();
  event.preventDefault();
  var gameInput = $("#game-input").val().trim();
  var gameTerm = $(this).attr("game-name");

  //  Ensures the user's button has at least 12 GIFs available from GIPHY API.
  // If there aren't 12, an error message will be shown and no button will be created.
  var queryURL = "https://api.giphy.com/v1/gifs/search?q=" + gameInput + "&limit=1&api_key=XNXXBU3B0vxwgDFnrUVQrnh1U12f5CSP" + "&offset=" + Math.floor((Math.random() * 100) + 1);

  //couldn't seem to get different gifs for each button press; tried "offset" and it WORKED! after I remembered I had two different sections w/ API calls! Now, I have varying reuslts when the same button is pressed more than once! (cool)
  // GIPHY documentation reference: https://developers.giphy.com/docs/

  $.ajax({
    url: queryURL,
    method: "GET"
  }).done(function(response) {

    if (response.pagination.total_count >= 12) {
      videoGames.push(gameInput);
      showButtons();
    } else if (response.pagination.total_count === 0) {
      $("#entry").html(" Sorry, nothing in the GIPHY database.  Please try again!");
    } else if (response.pagination.total_count === 1) {
      $("#entry").html(" Sorry, there was only 1 result for this.  Please try again.");
    } else {
      $("#entry").html(" Sorry, there were only " + response.pagination.total_count + " results for this.  Please try again.");
    }
    $("#game-input").val("");
  });

});

$(document).on("click", ".game", display);

function display() {

  // Clears out error message (if one pops up)
  $("#entry").empty();

  // defines and then executes; clears old gifs when new gifs are called after button press <-----this is now working; was referencing the wrong section at first (i.e. "theMagic" id instead of the correct "ratings" id)
  function clearGifs() {
    $("#ratings").empty();
  }
  clearGifs();

  var gameTerm = $(this).attr("game-name");

  // The GIPHY query.  This limits to 12 results
  var queryURL = "https://api.giphy.com/v1/gifs/search?q=" + gameTerm + "&limit=12&api_key=XNXXBU3B0vxwgDFnrUVQrnh1U12f5CSP" + "&offset=" + Math.floor((Math.random() * 100) + 1);

  $.ajax({
    url: queryURL,
    method: "GET"
  }).done(function(response) {

    // This runs 10 times (limit is 10 per above query) to show all the GIPHY pictures from the website's API response.
    for (var i = 0; i < response.data.length; i++) {

      // Gets the animated gif URL
      var active = response.data[i].images.fixed_width.url;
      // Gets the still gif URL
      var still = response.data[i].images.fixed_width_still.url;
      var rating = "Rating: " + (response.data[i].rating).toUpperCase();

      // Creates the new img item
      var gameGIF = $("<img>");

      // Changes the text color of ratings to green so can be seen against background more easily
      $("#ratings");

      // This creates a new div for the rating so that it maintains the gifs size
      var ratingDiv = $("<div id='ratingDiv'>" + rating + "</div>");

      gameGIF.attr({
        "active": active,
        "still": still,
        "src": still,
        "state": "still"
      });

      // This holds the new div for both the image itself and the associated rating. All images should be paired w/ their rating.
      var ratingAndImage = $("<div class='floatLeft'>");

      $(ratingAndImage).prepend(gameGIF, ratingDiv);

      // This adds the rating and image to the page.
      $("#ratings").prepend(ratingAndImage);

      // When the user clicks on a GIF, this will either start or stop the animation of said GIF.
      $(gameGIF).on("click", function(event) {

        // Clears out any error messages, concerning query response i.e. number of results (if there are too few)
        $("#entry").empty();

        var state = $(this).attr("state");
        var source = $(this).attr("src");

        if (state === "still") {
          $(this).attr("src", $(this).attr("active"));
          $(this).attr("state", "active");
        } else {
          $(this).attr("src", $(this).attr("still"));
          $(this).attr("state", "still");
        }
      });

    }

  });

}
</script>



